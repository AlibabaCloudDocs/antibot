# 精准访问控制 {#task_umw_rft_l2c .task}

通过精准访问控制策略，您可以根据您的业务场景定制访问控制规则。通过将常见的HTTP字段（如IP、URL、Referer、UA、参数等）进行组合形成匹配条件，筛选网站域名的访问请求，并对命中条件的访问请求配置观察、阻断、滑块或放行等处置动作。

**规则说明**

精准访问控制规则由**规则条件**与**处置动作**构成。在创建规则时，您通过设置匹配字段、逻辑符和相应的匹配内容定义匹配条件，并针对符合匹配条件规则的访问请求定义相应的处置动作。

-   **规则条件**

    规则条件包含匹配字段、逻辑符、匹配内容三个要素。

    |匹配字段|字段描述|适用逻辑符|
    |----|----|-----|
    |URL|访问请求的URL地址。|     -   包含
    -   不包含
    -   等于
    -   不等于
 |
    |IP|访问请求的来源IP。|     -   属于
    -   不属于
 |
    |Referer|访问请求的来源网址，即该访问请求是从哪个页面跳转产生的。|     -   包含
    -   不包含
    -   等于
    -   不等于
    -   长度小于
    -   长度等于
    -   长度大于
    -   不存在
 |
    |User-Agent|发起访问请求的客户端的浏览器标识、渲染引擎标识和版本信息等浏览器相关信息。|     -   包含
    -   不包含
    -   等于
    -   不等于
    -   长度小于
    -   长度等于
    -   长度大于
 |
    |Params|访问请求的URL地址中的参数部分，通常指URL中”?”后面的部分。例如，`www.abc.com/index.html?action=login`中的`action=login`就是参数部分。|     -   包含
    -   不包含
    -   等于
    -   不等于
    -   长度小于
    -   长度等于
    -   长度大于
 |
    |Cookie|访问请求中的Cookie信息。|     -   包含
    -   不包含
    -   等于
    -   不等于
    -   长度小于
    -   长度等于
    -   长度大于
    -   不存在
 |
    |Content-Type|访问请求指定的响应HTTP内容类型，即MIME类型信息。|     -   包含
    -   不包含
    -   等于
    -   不等于
    -   长度小于
    -   长度等于
    -   长度大于
 |
    |Content-Length|访问请求的响应内容所包含的字节数。|     -   值小于
    -   值等于
    -   值大于
 |
    |X-Forwarded-For|访问请求的客户端真实IP。**说明：** X-Forwarded-For（XFF）用来识别通过HTTP代理或负载均衡方式转发的访问请求的客户端最原始的IP地址的HTTP请求头字段，只有通过HTTP代理或者负载均衡服务器转发的访问请求才会包含该项。

|     -   包含
    -   不包含
    -   等于
    -   不等于
    -   长度小于
    -   长度等于
    -   长度大于
    -   不存在
 |
    |Post-Body|访问请求的响应内容信息。|     -   包含
    -   不包含
    -   等于
    -   不等于
 |
    |Http-Method|访问请求的方法，如GET、POST等。|     -   等于
    -   不等于
 |
    |Header|访问请求的头部信息，用于自定义HTTP头部字段。|     -   包含
    -   不包含
    -   等于
    -   不等于
    -   长度小于
    -   长度等于
    -   长度大于
    -   不存在
 |

-   **处置动作**

    精准访问控制规则支持以下匹配动作：

    -   **阻断**： 符合匹配条件的访问请求将被直接阻断。
    -   **放行**： 符合匹配条件的访问请求将被放行。
    -   **观察**： 符合匹配条件的访问请求将被放行，同时可以在数据报表中查看到匹配规则的请求，用于观察精准访问控制规则的效果。
    -   **滑块**： 符合匹配条件的访问请求将给客户端发送滑块验证进行二次人机识别验证。访问者需要滑动滑块完成验证，通过验证方可继续进行业务操作，无法通过（不操作或者验证为非人为操作）则业务操作将被中断。
-   **规则匹配顺序**

    如果您设置了多条精准访问控制规则，则规则间存在先后匹配顺序，即访问请求将根据您设定的精准访问控制规则顺序依次进行匹配，顺序靠前的精准访问控制规则优先进行匹配。当访问请求满足规则匹配条件后，将依此规则对访问请求执行处置动作，且不再继续匹配其他精准访问控制规则；若未满足匹配条件，则按顺序继续匹配下一条精准访问控制规则。

    您可以通过规则排序功能对所有精准访问控制规则进行排序，以获得最优的防护效果。


**默认规则说明**

精准访问控制规则中包含一条系统默认规则：

-   **规则条件**：所有未命中以上规则的请求。即当您启用精准访问控制策略后，所有未命中您所设置的精准访问控制规则的访问请求都将执行该默认规则的处置动作。
-   **处置动作**：默认处置动作为放行且后续继续执行其他安全策略，即所有未命中您所设置的精准访问控制规则的访问请求将被放行并继续执行其他防护策略（频次控制、APP端防护）。

**说明：** 默认规则不可删除，且其匹配条件不可修改。默认规则的排序不可调整，永远在最后执行匹配。

1.  登录[爬虫风险管理控制台](https://yundun.console.aliyun.com/?p=antibot)，选择您的Anti-Bot实例所在的地区。 
2.  定位到**防护配置** \> **精准访问控制**页面，选择已接入防护的域名。 
3.  单击**生效状态**开关![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15835/155564564935020_zh-CN.png)，开启精准访问控制防护策略。 
4.  单击**添加**，设置规则的匹配条件和相应的处置动作，完成后单击**确定**。 

    **说明：** 当选择Header作为匹配字段时，需要额外设置自定义Header中的key字段。例如，Header字段中带有业务含义的字段为`userid＝xxxxxx`，则需要在自定义Header字段中填写`userid`，即可将userid字段的作为匹配条件。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15835/15556456497163_zh-CN.png)

    规则添加成功后，您可以**编辑**其内容或将其**删除**。如果已添加多条规则，在精准访问控制页面单击**排序**，通过**上移**、**下移**、**置顶**、**置底**等操作可调整规则的匹配顺序，越靠上的规则越优先匹配。规则顺序调整完成后，单击**保存排序**即可生效。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/15835/15556456507164_zh-CN.png)


